# Stochastic Differential Equations

Stochastic differential equations (SDEs) are differential equations driven by **Brownian motion**.  
They provide the canonical way to define **diffusion processes** and connect stochastic calculus to PDE, generators, and change of measure.

Throughout, let \((\Omega,\mathcal{F},\{\mathcal{F}_t\},\mathbb{P})\) be a filtered probability space carrying a Brownian motion \(W_t\).

---

## 1. From Itô Integrals to SDEs

An **Itô process** has the form

\[
X_t = X_0 + \int_0^t b(s,X_s)\,ds + \int_0^t \sigma(s,X_s)\,dW_s.
\]



Writing this in differential notation motivates the SDE

\[
\boxed{
dX_t = b(t,X_t)\,dt + \sigma(t,X_t)\,dW_t, \qquad X_0=x.
}
\]



Here:
- \(b\) is the **drift** (deterministic trend),
- \(\sigma\) is the **diffusion coefficient** (random fluctuation intensity).

> Important: the “\(dX_t\)” notation is shorthand for the integral equation above.

---

## 2. What Is a Solution?

There are several notions of solution; the most common in this book is the **strong solution**.

### 2.1 Strong solution
A process \(X_t\) is a strong solution of

\[
dX_t=b(t,X_t)dt+\sigma(t,X_t)dW_t
\]


if:
- \(X_t\) is adapted to the given filtration \(\{\mathcal{F}_t\}\) (in particular, the one generated by \(W_t\)),
- \(\int_0^T |b(t,X_t)|dt < \infty\) and \(\int_0^T \sigma(t,X_t)^2 dt < \infty\) a.s.,
- and the integral equation holds for all \(t\in[0,T]\).

### 2.2 Weak solution (idea)
A weak solution allows changing the probability space and Brownian motion.  
Weak solutions are important for distributional questions and connections to martingale problems.

(We return to this viewpoint when discussing the **Stroock–Varadhan martingale problem**.)

---

## 3. Itô’s Lemma for SDEs

If \(X_t\) solves

\[
dX_t=b(t,X_t)dt+\sigma(t,X_t)dW_t
\]


and \(f\in C^{1,2}\), then Itô’s lemma gives

\[
\boxed{
df(t,X_t)
=
\Big(f_t + b f_x + \tfrac12 \sigma^2 f_{xx}\Big)(t,X_t)\,dt
+ \sigma(t,X_t) f_x(t,X_t)\,dW_t.
}
\]



This formula is the gateway to:
- infinitesimal generators,
- martingales built from \(X_t\),
- Kolmogorov equations and Feynman–Kac.

---

## 4. Canonical Examples

### 4.1 Brownian motion with drift

\[
dX_t=\mu\,dt+dW_t
\quad\Rightarrow\quad
X_t = X_0 + \mu t + W_t.
\]



### 4.2 Geometric Brownian motion (GBM)

\[
\boxed{
dS_t = \mu S_t\,dt + \sigma S_t\,dW_t.
}
\]


Applying Itô’s lemma to \(\log S_t\) yields the explicit solution

\[
S_t = S_0\exp\Big((\mu-\tfrac12\sigma^2)t + \sigma W_t\Big).
\]



GBM is the core model behind Black–Scholes.

### 4.3 Ornstein–Uhlenbeck (OU) process

\[
dX_t = \kappa(\theta - X_t)\,dt + \sigma\,dW_t.
\]


This is a mean-reverting Gaussian diffusion; it is a continuous-time analogue of AR(1).

---

## 5. Existence and Uniqueness (Preview)

A standard theorem (proved/expanded in the next section) says:

If \(b(t,x)\) and \(\sigma(t,x)\) are **globally Lipschitz** in \(x\) and have **linear growth**, then the SDE admits a **unique strong solution**.

This is the basic well-posedness result that turns “formal dynamics” into a mathematically defined process.

---

## 6. Simulation: Euler–Maruyama Scheme

SDEs rarely have closed-form solutions, so simulation is essential.

For

\[
dX_t=b(t,X_t)dt+\sigma(t,X_t)dW_t,
\]


Euler–Maruyama on a grid \(t_n=n\Delta t\) is

\[
\boxed{
X_{n+1} = X_n + b(t_n,X_n)\,\Delta t + \sigma(t_n,X_n)\,\Delta W_n,
}
\]


with \(\Delta W_n\sim\mathcal{N}(0,\Delta t)\) independent.

### Python example: simulate_GBM_Euler_Maruyama

```python
import numpy as np
import matplotlib.pyplot as plt

T = 1.0
N = 500
dt = T / N
t = np.linspace(0, T, N+1)

S0 = 1.0
mu = 0.2
sigma = 0.5

num_paths = 20
S = np.zeros((num_paths, N+1))
S[:, 0] = S0

for p in range(num_paths):
    dW = np.sqrt(dt) * np.random.randn(N)
    for n in range(N):
        S[p, n+1] = S[p, n] + mu * S[p, n] * dt + sigma * S[p, n] * dW[n]

fig, ax = plt.subplots(figsize=(10, 4))
for p in range(num_paths):
    ax.plot(t, S[p])
ax.set_title("Geometric Brownian Motion (Euler–Maruyama)", fontsize=14)
ax.set_xlabel("t")
ax.set_ylabel("S_t")
ax.grid(True, alpha=0.3)
for spine in ["top", "right"]:
    ax.spines[spine].set_visible(False)
plt.tight_layout()
plt.show()
```

---

## 7. Summary

- An SDE is an integral equation driven by Brownian motion.
- Itô’s lemma converts SDE dynamics into drift/diffusion rules for functions of the process.
- Existence/uniqueness ensures the SDE defines a well-posed diffusion.
- Euler–Maruyama provides a practical simulation method when explicit solutions are unavailable.
